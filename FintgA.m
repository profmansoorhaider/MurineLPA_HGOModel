%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Function:     FintgA.m
% Author:       Mansoor A Haider
% Date:         11/15/2022
% Version:      1.0
% Reference:    MA Haider, KJ Pearce, NC Chesler, NA Hill and MS Olufsen, 
%               Application and reduction of a nonlinear hyperelastic wall 
%               model capturing ex vivo relationships between fluid 
%               pressure, area and wall thickness in normal and hypertensive 
%               murine left pulmonary arteries (under review)
% Purpose:      Function to generate the integrand for the second integral  
%               in equation (9)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function intg = FintgA(r,rin1,Rin0,cM,cA,k1M,k2A,k1A,hRef) 

global k beta Lz

%%% Set the twist angle
Phi=0;
%%% Set the reference axial length at 1 (without loss of generality) when 
%%% the twist angle is zero
l=1;

%%% Use the media fiber angle to calculate the Lagrangian fiber directions 
%%% in equation (6)
a01RA=0; a01HA=cos(beta*pi/180); a01ZA=sin(beta*pi/180);   
a02RA=0; a02HA=cos(beta*pi/180); a02ZA=-sin(beta*pi/180);  

Iv=ones(size(r));
Rin=Rin0*Iv;
rin=rin1*Iv;

%%% Calculate the integrand for the second integral in equation (9)
intgA = 0.1e1*1./r.* (cA * (0.2e1 / 0.3e1 / Lz ^ 2 / k ^ 2 / 1./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz)...
   - r.^ 2 * Phi ^ 2 / l ^ 2 * Lz ^ 2 / 0.3e1 - k ^ 2 * r.^ 2 ./(Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) ./0.3e1 -...
    Lz ^ 2./0.3e1) + 0.2e1 * k1A * (a01RA ^ 2 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + ...
    0.2e1 * a01HA * a01ZA * k * r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz).^ (-0.1e1 ./0.2e1) * Phi ./l * Lz + ...
    a01HA ^ 2 * k ^ 2 * r.^ 2 ./(Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + a01ZA ^ 2 * (r.^ 2 * Phi ^ 2 ./l ^ 2 * Lz ^ 2 +...
    Lz ^ 2) - 0.1e1) .* exp(k2A * (a01RA ^ 2 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) +...
    0.2e1 * a01HA * a01ZA * k * r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz).^ (-0.1e1 ./0.2e1) * Phi ./l * Lz +...
    a01HA ^ 2 * k ^ 2 * r.^ 2 ./(Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + a01ZA ^ 2 * (r.^ 2 .* Phi ^ 2 ./l ^ 2 * Lz ^ 2 +...
    Lz ^ 2) - 0.1e1).^ 2) .* (0.2e1 ./0.3e1 * a01RA ^ 2 - a01HA ^ 2 ./0.3e1 - a01ZA ^ 2 ./0.3e1) +...
    0.2e1 * k1A * (a02RA ^ 2 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) +...
    0.2e1 * a02HA * a02ZA * k * r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz).^ (-0.1e1 ./0.2e1) * Phi ./l * Lz +...
    a02HA ^ 2 * k ^ 2 * r.^ 2 ./(Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + a02ZA ^ 2 * (r.^ 2 .* Phi ^ 2 ./l ^ 2 * Lz ^ 2 +...
    Lz ^ 2) - 0.1e1) .* exp(k2A * (a02RA ^ 2 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) +...
    0.2e1 * a02HA * a02ZA * k * r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz).^ (-0.1e1 ./0.2e1) * Phi ./l * Lz +...
    a02HA ^ 2 * k ^ 2 * r.^ 2 ./(Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + a02ZA ^ 2 * (r.^ 2 * Phi ^ 2 ./l ^ 2 * Lz ^ 2 +...
    Lz ^ 2) - 0.1e1).^ 2) .* (0.2e1 ./0.3e1 * a02RA ^ 2 - a02HA ^ 2 ./0.3e1 - a02ZA ^ 2 ./0.3e1) -...
    cA * (0.2e1 ./0.3e1 * r.^ 2 .* Phi ^ 2 ./l ^ 2 * Lz ^ 2 + 0.2e1 ./0.3e1 * k ^ 2 * r.^ 2 ./(Rin.^ 2 +...
    (r.^ 2 - rin.^ 2) * k * Lz) - 0.1e1 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) ./0.3e1 -...
    Lz ^ 2 ./0.3e1) - 0.2e1 * k1A * (a01RA ^ 2 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) +...
    0.2e1 * a01HA * a01ZA * k * r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz).^ (-0.1e1 ./0.2e1) * Phi ./l * Lz +...
    a01HA ^ 2 * k ^ 2 * r.^ 2 ./(Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + a01ZA ^ 2 * (r.^ 2 .* Phi ^ 2 ./l ^ 2 * Lz ^ 2 +...
    Lz ^ 2) - 0.1e1) .* exp(k2A * (a01RA ^ 2 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) +...
    0.2e1 * a01HA * a01ZA * k * r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz).^ (-0.1e1 ./0.2e1) .* Phi ./l * Lz +...
    a01HA ^ 2 * k ^ 2 * r.^ 2 ./(Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + a01ZA ^ 2 * (r.^ 2 .* Phi ^ 2 ./l ^ 2 * Lz ^ 2 +...
    Lz ^ 2) - 0.1e1).^ 2) .* (0.2e1 ./0.3e1 * a01HA ^ 2 - a01RA ^ 2 ./0.3e1 - a01ZA ^ 2 ./0.3e1) -...
    0.2e1 * k1A * (a02RA ^ 2 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) .* k * Lz) + 0.2e1 .* a02HA * a02ZA *...
    k * r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz).^ (-0.1e1 ./0.2e1) * Phi ./l * Lz + a02HA ^ 2 * k ^ 2 * r.^ 2 ./...
    (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + a02ZA ^ 2 * (r.^ 2 * Phi ^ 2 ./l ^ 2 * Lz ^ 2 + Lz ^ 2) - 0.1e1) .* exp(k2A *...
    (a02RA ^ 2 ./Lz ^ 2 ./k ^ 2 ./r.^ 2 .* (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz) + 0.2e1 * a02HA * a02ZA * k * r.^ 2 .*...
    (Rin.^ 2 + (r.^ 2 - rin.^ 2) * k * Lz).^ (-0.1e1 ./0.2e1) .* Phi ./l * Lz + a02HA ^ 2 * k ^ 2 * r.^ 2 ./(Rin.^ 2 +...
    (r.^ 2 - rin.^ 2) * k * Lz) + a02ZA ^ 2 * (r.^ 2 * Phi ^ 2 ./l ^ 2 * Lz ^ 2 + Lz ^ 2) - 0.1e1).^ 2) .* (0.2e1 ./0.3e1 *...
    a02HA ^ 2 - a02RA ^ 2 ./0.3e1 - a02ZA ^ 2 ./0.3e1));

intg = intgA;